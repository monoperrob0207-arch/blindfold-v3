"use strict";(()=>{var e={};e.id=579,e.ids=[579],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},9884:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>x,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>v,staticGenerationAsyncStorage:()=>l});var o={};t.r(o),t.d(o,{POST:()=>u,dynamic:()=>i});var s=t(9303),a=t(8716),p=t(670),n=t(7070);let i="force-dynamic";async function u(e){try{var r=await e.json(),o=r.proposalId,s=r.approved,a=r.approvedBy||"user";if(!o)return n.NextResponse.json({error:"proposalId is required"},{status:400});var p=t(7147),i=t(1017),u=i.join(process.cwd(),"data"),d=i.join(u,"proposals.json"),c=i.join(u,"tasks.json"),l=[];try{p.existsSync(d)&&(l=JSON.parse(p.readFileSync(d,"utf-8")))}catch(e){}var v=l.find(e=>e.id===o);if(!v)return n.NextResponse.json({error:"Proposal not found"},{status:404});v.status=s?"approved":"rejected",v.approvedBy=a,v.approvedAt=new Date().toISOString();var f=l.filter(e=>e.id!==o);if(p.writeFileSync(d,JSON.stringify([...f,v],null,2)),s){var x=[];try{p.existsSync(c)&&(x=JSON.parse(p.readFileSync(c,"utf-8")))}catch(e){}var S={id:"task_"+Date.now(),proposalId:o,agent:v.agent,task:v.task,reason:v.reason,expectedOutcome:v.expectedOutcome,status:"in_progress",startedAt:new Date().toISOString()};x.unshift(S),p.writeFileSync(c,JSON.stringify(x,null,2))}return n.NextResponse.json({proposal:v,timestamp:new Date().toISOString()})}catch(e){return n.NextResponse.json({error:e instanceof Error?e.message:"Unknown error"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/v3/proposals/approve/route",pathname:"/api/v3/proposals/approve",filename:"route",bundlePath:"app/api/v3/proposals/approve/route"},resolvedPagePath:"/home/ubuntu/.openclaw/workspace/blindfold-v3/src/app/api/v3/proposals/approve/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:c,staticGenerationAsyncStorage:l,serverHooks:v}=d,f="/api/v3/proposals/approve/route";function x(){return(0,p.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:l})}}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[948,972],()=>t(9884));module.exports=o})();