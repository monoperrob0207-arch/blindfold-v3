"use strict";(()=>{var e={};e.id=579,e.ids=[579],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7147:e=>{e.exports=require("fs")},9884:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>m,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>v,staticGenerationAsyncStorage:()=>l});var o={};t.r(o),t.d(o,{POST:()=>u,dynamic:()=>i});var a=t(9303),s=t(8716),p=t(670),n=t(7070);let i="force-dynamic";async function u(e){try{var r=await e.json(),o=r.proposalId,a=r.approved,s=r.approvedBy||"user";if(!o)return n.NextResponse.json({error:"proposalId is required"},{status:400});var p=t(7147),i="/home/ubuntu/.openclaw/workspace/blindfold-v3/data/proposals.json",u="/home/ubuntu/.openclaw/workspace/blindfold-v3/data/tasks.json",d=[];try{p.existsSync(i)&&(d=JSON.parse(p.readFileSync(i,"utf-8")))}catch(e){}var c=d.find(e=>e.id===o);if(!c)return n.NextResponse.json({error:"Proposal not found"},{status:404});c.status=a?"approved":"rejected",c.approvedBy=s,c.approvedAt=new Date().toISOString();var l=d.filter(e=>e.id!==o);if(p.writeFileSync(i,JSON.stringify([...l,c],null,2)),a){var v=[];try{p.existsSync(u)&&(v=JSON.parse(p.readFileSync(u,"utf-8")))}catch(e){}var f={id:"task_"+Date.now(),proposalId:o,agent:c.agent,task:c.task,reason:c.reason,expectedOutcome:c.expectedOutcome,status:"in_progress",startedAt:new Date().toISOString()};v.unshift(f),p.writeFileSync(u,JSON.stringify(v,null,2))}return n.NextResponse.json({proposal:c,timestamp:new Date().toISOString()})}catch(e){return n.NextResponse.json({error:e instanceof Error?e.message:"Unknown error"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/v3/proposals/approve/route",pathname:"/api/v3/proposals/approve",filename:"route",bundlePath:"app/api/v3/proposals/approve/route"},resolvedPagePath:"/home/ubuntu/.openclaw/workspace/blindfold-v3/src/app/api/v3/proposals/approve/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:c,staticGenerationAsyncStorage:l,serverHooks:v}=d,f="/api/v3/proposals/approve/route";function m(){return(0,p.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:l})}}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[948,972],()=>t(9884));module.exports=o})();